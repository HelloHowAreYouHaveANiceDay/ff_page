---
title: Top 250
---

# Top 250 Players

```js
// DATA LOADER
const plays = await FileAttachment("data/players.json").json();
// console.log(plays);
```

```js
import { gamePointsIndicator } from "./formatHelpers.js";

function sparkbar(max) {
  return (x) => htl.html`<div style="
      background: var(--theme-foreground-focus);
      color: white;
      font: 10px/1.6 var(--sans-serif);
      width: ${(100 * x) / max}%;
      float: right;
      padding-right: 3px;
      box-sizing: border-box;
      overflow: visible;
      display: flex;
      justify-content: end;">${x.toLocaleString("en-US")}`;
}

function sparkbar_green(max) {
  return (x) => htl.html`<div style="
      background: var(--theme-green);
      color: white;
      font: 10px/1.6 var(--sans-serif);
      width: ${(100 * x) / max}%;
      float: right;
      padding-right: 3px;
      box-sizing: border-box;
      overflow: visible;
      display: flex;
      justify-content: end;">${x.toLocaleString("en-US")}`;
}

function sparkbar_blue(max) {
  return (x) => htl.html`<div style="
      background: var(--theme-blue);
      color: white;
      font: 10px/1.6 var(--sans-serif);
      width: ${(100 * x) / max}%;
      float: right;
      padding-right: 3px;
      box-sizing: border-box;
      overflow: visible;
      display: flex;
      justify-content: end;">${x.toLocaleString("en-US")}`;
}

function sparkbar_red(max) {
  return (x) => htl.html`<div style="
      background: var(--theme-red);
      color: white;
      font: 10px/1.6 var(--sans-serif);
      width: ${(100 * x) / max}%;
      float: right;
      padding-right: 3px;
      box-sizing: border-box;
      overflow: visible;
      display: flex;
      justify-content: end;">${x.toLocaleString("en-US")}`;
}

// helper functions

function positionIndicator(d) {
  return d === "RB"
    ? "🎳RB"
    : d === "WR"
    ? "🧤WR"
    : d === "TE"
    ? "🛠TE"
    : d === "QB"
    ? "🏈QB"
    : d;
}

function consistency(d) {
  // get the standard deviation of the fantasy points
  const std = d3.deviation(d.map((x) => x.fantasy_points));
}
```

```js
const results = view(
  Inputs.search(plays, {
    placeholder: "Search for a player",
  })
);

// const filtered = plays.filter((d) => d.player_name);
```

```js
function topTwoFifty(data, { width }) {
  return Inputs.table(
    results.sort((a, b) => b.fantasy_points - a.fantasy_points).slice(0, 250),
    {
      columns: [
        "rank",
        "pos_rank",
        "team_abbr",
        "position",
        "games",
        "player_name",
        "pass_fantasy_points",
        "rec_fantasy_points",
        "rush_fantasy_points",
        "fantasy_points",
        "fp_game_list",
      ],
      format: {
        position: (d) => `${positionIndicator(d)}`,
        fp_game_list: (d) => d.map((x) => `${gamePointsIndicator(x)}`).join(""),
        fantasy_points: sparkbar(d3.max(data, (d) => d.fantasy_points)),
        pass_fantasy_points: sparkbar_green(
          d3.max(data, (d) => d.pass_fantasy_points)
        ),
        rec_fantasy_points: sparkbar_blue(
          d3.max(data, (d) => d.rec_fantasy_points)
        ),
        rush_fantasy_points: sparkbar_red(
          d3.max(data, (d) => d.rush_fantasy_points)
        ),
      },
      align: {
        fp_game_list: "right",
      },
      rows: 300,
    }
  );
}
```

<div class="">
   ${resize((width) => topTwoFifty(plays, {width}))}
</div>
